<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Pipe it, curry it, tacit!</title>

    <link rel="stylesheet" href="dist/reset.css" />
    <link rel="stylesheet" href="dist/reveal.css" />
    <link rel="stylesheet" href="dist/theme/forest-dark.css" id="theme" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/forest-dark.css" id="highlight-theme" />

    <style>
      :root {
        --gradient: linear-gradient(120deg, var(--selection-background-color) 0%, var(--link-color) 100%);
      }

      cite {
        display: block;
        font-size: 2vmin;
      }

      .gradient-text {
        background-image: var(--gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        -moz-background-clip: text;
        -moz-text-fill-color: transparent;
      }
      .gradient-bar {
        width: 100%;
        height: 5vmin;
        background: var(--gradient);
        transform: skewX(-30deg);
        border-radius: 5px;
      }
      .gradient-indicator {
        position: absolute;
        bottom: -9vmin;
        left: 0;
        font-size: 10vmin;
        transform: translateX(-50%);
        opacity: 0;
        text-shadow: 0 0 1vmin rgba(255, 255, 255, 0.5);
        transition: all 600ms ease-in-out;
      }

      /* override */
      .fragment.fade-in-then-out:not(.current-fragment) {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section>
          <section>
            <h1 class="gradient-text" style="text-align: left">
              <span>Pipe it</span><br />
              <span style="margin-left: 20%">curry it</span><br />
              <span style="margin-left: 64%">tacit</span>
            </h1>
          </section>

          <section>
            <img src="assets/logo-frontmen.svg" style="height: 25vmin" />
            <h3>
              <img src="assets/avatar.svg" style="height: 8vmin; margin: 0; vertical-align: text-bottom" />
              Abbe Keultjes
            </h3>
            <p>abbe.keultjes@frontmen.nl</p>
          </section>
        </section>

        <section>
          <section class="r-stretch">
            <h3>More declarative</h3>
            <div class="fragment" style="position: relative; margin-bottom: 10vmin">
              <div style="display: flex; justify-content: space-between">
                <span style="margin-bottom: 1rem">Imperative</span>
                <span style="margin-bottom: 1rem">Declarative</span>
              </div>
              <div class="gradient-bar"></div>
              <div class="gradient-indicator">⬆</div>
            </div>
            <pre class="fragment fade-in-then-out" data-indicator-left="5%"><code class="js" data-trim>
              const charCodes = [115, null, 104, 105, 116]
              let result = ''

              for (let i = 0; i < charCodes.length; i++) {
                const charCode = charCodes[i]
                if (!charCode) {
                  continue
                }
                result += String.fromCharCode(charCode)
              }

              result // 'shit'
            </code></pre>
            <pre class="fragment fade-in-then-out" data-indicator-left="40%"><code class="js" data-trim>
              const charCodes = [98, 101, 116, 116, 101, null, 114]
              const result = charCodes
                .filter((charCode) => charCode)
                .map((charCode) => String.fromCharCode(charCode))
                .join('')

              result // 'better'
            </code></pre>
            <pre class="fragment fade-in-then-out" data-indicator-left="75%"><code class="js" data-trim>
              const charCodes = [98, 101, null, 115, 116]
              const makeWord = pipe(
                reject(isNil),
                map(String.fromCharCode),
                join('')
              )

              makeWord(charCodes) // 'best'
            </code></pre>
            <pre class="fragment fade-in-then-out" data-indicator-left="95%"><code class="js" data-trim>
              const incCount = ifElse(
                has('count'),
                over(lensProp('count'), inc),
                assoc('count', 1)
              )
              incCount({})            // { count: 1 }
              incCount({ count: 1 })  // { count: 2 }
            </code></pre>

            <blockquote class="fragment fade-in-then-out">
              “Familiarity can be acquired; complexity is intrinsic.”
              <cite><a href="https://sanctuary.js.org/#section:currying" target="_blank">sanctuary.js</a></cite>
            </blockquote>
          </section>
          <section>
            <!-- todo: remove this slide? -->
            <h3>Assumptions</h3>
            <ul>
              <li class="fragment">
                Functions are <em>first-class</em>. They can be…
                <ul>
                  <li class="fragment">
                    …stored in a variable
                    <pre><code class="js" data-trim>
                      const fn = () => { … }
                    </code></pre>
                  </li>
                  <li class="fragment">
                    …passed as an argument
                    <pre><code class="js" data-trim>
                      const fn = (callback) => {
                        …
                        callback()
                      }
                    </code></pre>
                  </li>
                  <li class="fragment">
                    …returned from a function
                    <pre class="fragment fade-in-then-out"><code class="js" data-trim>
                      const fn = () => {
                        return () => { … }
                      }
                    </code></pre>
                    <pre class="fragment"><code class="js" data-trim>
                      const fn = () => () => { … }
                    </code></pre>
                  </li>
                </ul>
              </li>
            </ul>
          </section>
        </section>

        <section>
          <!--
            Pass a value through multiple functions
            Compose
            Pipe
            Pipeline operator?
           -->
        </section>

        <section>
          <!--
            What's currying? (uses closures) (inventor: Haskell Curry)
            Why currying? Reusability and readability (Angular animation example, RxJS?)
            Difference with partial application
            Ramda mixes currying with partial application
            https://blog.bitsrc.io/understanding-currying-in-javascript-ceb2188c339
           -->
        </section>

        <section>
          <!--
            Tacit (point-free) programming: explicitly referred arguments ("points")
            ```
            const getName = (person) => person.name
            const people = [{ name: 'Hank' }, ...]
            people.map((person) => getName(person))

            // point-free:
            people.map(getName)
            ```
            This doesn't always work (e.g. Number.parseInt())
            Pipe() is already point-free
            Using `this` makes it harder to be point-free
            https://medium.com/dailyjs/functional-js-7-point-free-style-b21a1416ac6a
           -->
        </section>

        <section>
          <!--
            Libs:
            * Ramda.js
            * Rambda https://selfrefactor.github.io/rambda/#/
            * Lodash FP?
            * https://sanctuary.js.org/
            * https://folktale.origamitower.com/ (more OO)
            * https://www.purescript.org/
            Further reading:
            * https://medium.com/dailyjs/functional-js-1-introduction-7908bfe5ef8d
            * https://project-awesome.org/stoeffel/awesome-fp-js
            * https://en.wikipedia.org/wiki/Tacit_programming
            Future subjects:
            * combinators
           -->
        </section>
      </div>
    </div>

    <script src="dist/reveal.js"></script>
    <script src="plugin/notes/notes.js"></script>
    <script src="plugin/markdown/markdown.js"></script>
    <script src="plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      })

      const log = (val) => {
        console.log(val)
        return val
      }
      const find = (fn) => (array) => array.find(fn)
      const some = (fn) => (array) => array.some(fn)
      const pipe = (...fns) => (val) => fns.reduce((acc, fn) => fn(acc), val)
      const getDataFor = (key) => (el) => el.dataset[key]
      const isVisible = (el) => el.classList.contains('current-fragment')
      const setStyle = (el) => (prop) => (value) => (el.style[prop] = value)

      const gradientIndicator = document.getElementsByClassName('gradient-indicator')[0]
      const codeSnippets = [...document.querySelectorAll('[data-indicator-left]')]
      const getGradientValue = getDataFor('indicatorLeft')
      const setIndicatorStyle = setStyle(gradientIndicator)
      const setIndicatorStyleLeft = pipe(find(isVisible), getGradientValue, setIndicatorStyle('left'))

      const updateIndicatorStyle = () => {
        if (some(isVisible)(codeSnippets)) {
          setIndicatorStyle('opacity')(1)
          setIndicatorStyleLeft(codeSnippets)
          return
        }
        setIndicatorStyle('opacity')(0)
      }

      Reveal.on('fragmentshown', updateIndicatorStyle)
      Reveal.on('fragmenthidden', updateIndicatorStyle)
    </script>
  </body>
</html>
